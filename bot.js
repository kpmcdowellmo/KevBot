// TODO finish converting to class implementation.